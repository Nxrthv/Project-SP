<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Documentos - Sistema de Gestión Académica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Estilos críticos inline para evitar bloqueo de renderizado */
        body {
            font-family: 'Inter', sans-serif;
        }
        
        /* Animaciones */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
        
        /* Transiciones suaves */
        .transition-all {
            transition: all 0.3s ease;
        }
        
        /* Efectos para tarjetas */
        .document-card {
            transition: all 0.2s ease-in-out;
        }
        
        .document-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Mejoras para scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }
        
        /* Mejoras de accesibilidad */
        :focus-visible {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }
        
        /* Mejoras para dispositivos táctiles */
        @media (hover: none) {
            .touch-target {
                min-height: 44px;
                min-width: 44px;
            }
        }
        
        /* Estilos para el toast de notificación */
        .toast {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            z-index: 50;
            transform: translateY(100%);
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        /* Estilos para resultados de búsqueda */
        #resultadosBusqueda {
            max-height: 300px;
            overflow-y: auto;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Efecto de pulso para botones */
        .btn-pulse {
            position: relative;
            overflow: hidden;
        }
        
        .btn-pulse::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%, -50%);
            transform-origin: 50% 50%;
        }
        
        .btn-pulse:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }
    </style>
</head>

<body class="bg-gradient-to-b from-slate-50 to-slate-100 min-h-screen">
    <%- include("reusables/nav") %>
    <!-- Contenido Principal -->
    <div class="container mx-auto px-4 py-8">
        <!-- Encabezado -->
        <div class="mb-6 animate-fade-in">
            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-2">
                <i data-lucide="file-text" class="h-7 w-7 text-blue-600"></i>
                Gestión de Documentos
            </h1>
            <p class="text-gray-600 mt-1">Genera, gestiona y descarga documentos oficiales</p>
        </div>

        <!-- Contenido Principal -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Panel Izquierdo - Tipos de Documentos -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6 transition-all hover:shadow-md animate-fade-in" style="animation-delay: 0.1s;">
                    <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                        <i data-lucide="files" class="h-5 w-5 text-blue-600"></i>
                        Tipos de Documentos
                    </h2>

                    <!-- Lista de Documentos -->
                    <div class="space-y-3 custom-scrollbar" style="max-height: 500px; overflow-y: auto;">
                        <div class="document-card bg-blue-50 border border-blue-100 rounded-lg p-4 cursor-pointer hover:shadow-md"
                            onclick="mostrarFormulario('constancia-vacante')">
                            <div class="flex items-center gap-3">
                                <div
                                    class="h-12 w-12 rounded-lg bg-green-100 flex items-center justify-center text-green-600 flex-shrink-0">
                                    <i data-lucide="file-check" class="h-6 w-6"></i>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900">Constancia de Vacante</h3>
                                    <p class="text-xs text-gray-500">Documento que certifica disponibilidad de vacante
                                    </p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="document-card bg-white border border-gray-100 rounded-lg p-4 cursor-pointer hover:shadow-md"
                            onclick="mostrarFormulario('constancia-estudios')">
                            <div class="flex items-center gap-3">
                                <div
                                    class="h-12 w-12 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600 flex-shrink-0">
                                    <i data-lucide="file-text" class="h-6 w-6"></i>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900">Constancia de Estudios</h3>
                                    <p class="text-xs text-gray-500">Documento que certifica la matrícula actual</p>
                                </div>
                            </div>
                        </div>

                        <div class="document-card bg-white border border-gray-100 rounded-lg p-4 cursor-pointer hover:shadow-md"
                            onclick="mostrarFormulario('resolucion-traslado')">
                            <div class="flex items-center gap-3">
                                <div
                                    class="h-12 w-12 rounded-lg bg-purple-100 flex items-center justify-center text-purple-600 flex-shrink-0">
                                    <i data-lucide="file-symlink" class="h-6 w-6"></i>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900">Resolución de Traslado</h3>
                                    <p class="text-xs text-gray-500">Documento oficial para traslado de estudiantes
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div class="document-card bg-white border border-gray-100 rounded-lg p-4 cursor-pointer hover:shadow-md"
                            onclick="mostrarFormulario('certificado-notas')">
                            <div class="flex items-center gap-3">
                                <div
                                    class="h-12 w-12 rounded-lg bg-amber-100 flex items-center justify-center text-amber-600 flex-shrink-0">
                                    <i data-lucide="file-bar-chart" class="h-6 w-6"></i>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900">Certificado de Notas</h3>
                                    <p class="text-xs text-gray-500">Documento oficial con calificaciones del
                                        estudiante</p>
                                </div>
                            </div>
                        </div>

                        <div class="document-card bg-white border border-gray-100 rounded-lg p-4 cursor-pointer hover:shadow-md"
                            onclick="mostrarFormulario('constancia-conducta')">
                            <div class="flex items-center gap-3">
                                <div
                                    class="h-12 w-12 rounded-lg bg-red-100 flex items-center justify-center text-red-600 flex-shrink-0">
                                    <i data-lucide="file-heart" class="h-6 w-6"></i>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900">Constancia de Conducta</h3>
                                    <p class="text-xs text-gray-500">Documento que certifica comportamiento del
                                        estudiante</p>
                                </div>
                            </div>
                        </div>

                        <div class="document-card bg-white border border-gray-100 rounded-lg p-4 cursor-pointer hover:shadow-md"
                            onclick="mostrarFormulario('documento-personalizado')">
                            <div class="flex items-center gap-3">
                                <div
                                    class="h-12 w-12 rounded-lg bg-gray-100 flex items-center justify-center text-gray-600 flex-shrink-0">
                                    <i data-lucide="file-plus" class="h-6 w-6"></i>
                                </div>
                                <div>
                                    <h3 class="font-medium text-gray-900">Documento Personalizado</h3>
                                    <p class="text-xs text-gray-500">Crea un documento con formato personalizado</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Documentos Recientes -->
                <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 transition-all hover:shadow-md animate-fade-in" style="animation-delay: 0.2s;">
                    <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                        <i data-lucide="history" class="h-5 w-5 text-blue-600"></i>
                        Documentos Recientes
                    </h2>
                    <div class="space-y-3">
                        <div class="flex items-center gap-3 border-b border-gray-100 pb-3 hover:bg-gray-50 rounded-lg p-2 transition-all">
                            <div class="h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600 flex-shrink-0">
                                <i data-lucide="file-text" class="h-5 w-5"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-sm font-medium text-gray-900">Constancia de Estudios - María López</h3>
                                <p class="text-xs text-gray-500">Generado hace 2 horas</p>
                            </div>
                            <button class="text-gray-400 hover:text-blue-600 p-2 rounded-full hover:bg-blue-50 transition-colors">
                                <i data-lucide="download" class="h-4 w-4"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center gap-3 border-b border-gray-100 pb-3 hover:bg-gray-50 rounded-lg p-2 transition-all">
                            <div class="h-10 w-10 rounded-lg bg-green-100 flex items-center justify-center text-green-600 flex-shrink-0">
                                <i data-lucide="file-check" class="h-5 w-5"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-sm font-medium text-gray-900">Constancia de Vacante - Carlos Rodríguez</h3>
                                <p class="text-xs text-gray-500">Generado ayer</p>
                            </div>
                            <button class="text-gray-400 hover:text-blue-600 p-2 rounded-full hover:bg-blue-50 transition-colors">
                                <i data-lucide="download" class="h-4 w-4"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center gap-3 hover:bg-gray-50 rounded-lg p-2 transition-all">
                            <div class="h-10 w-10 rounded-lg bg-amber-100 flex items-center justify-center text-amber-600 flex-shrink-0">
                                <i data-lucide="file-bar-chart" class="h-5 w-5"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="text-sm font-medium text-gray-900">Certificado de Notas - Pedro Gómez</h3>
                                <p class="text-xs text-gray-500">Generado hace 3 días</p>
                            </div>
                            <button class="text-gray-400 hover:text-blue-600 p-2 rounded-full hover:bg-blue-50 transition-colors">
                                <i data-lucide="download" class="h-4 w-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Panel Derecho - Formulario y Vista Previa -->
            <div class="lg:col-span-2">
                <!-- Formularios (solo se muestra uno a la vez) -->
                <div>
                    <div id="constancia-vacante"
                        class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6 transition-all hover:shadow-md animate-fade-in" style="animation-delay: 0.3s;">

                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                                <i data-lucide="file-check" class="h-5 w-5 text-green-600"></i>
                                Constancia de Vacante
                            </h2>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-gray-500">ID: DOC-2025-32004</span>
                                <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800">Oficial</span>
                            </div>
                        </div>
    
                        <div class="grid grid-cols-1 md:grid-cols-1">
                            <!-- Columna Izquierda - Formulario -->
                            <div>
                                <h3 class="text-sm font-medium text-gray-700 mb-4 flex items-center gap-2">
                                    <i data-lucide="user" class="h-4 w-4 text-blue-600"></i>
                                    Información del Estudiante
                                </h3>
                                <!-- Datos del Estudiante -->
                                <div class="space-y-4">
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                            <div class="col-span-1">
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Apellido Paterno</label>
                                                <input id="lastname1" name="lastname1" type="text"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" required>
                                            </div>
                                            <div class="col-span-1">
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Apellido Materno</label>
                                                <input id="lastname2" name="lastname2" type="text"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" required>
                                            </div>
                                            <div class="col-span-1">
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Nombre Completo</label>
                                                <input id="name" name="name" type="text"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" required>
                                            </div>
                                        </div>
                                        
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">DNI</label>
                                                <input id="dni" name="dni" type="text" placeholder="DNI del Estudiante"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Nivel Educativo</label>
                                                <select id="nivel" name="nivel"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white" required>
                                                    <option selected>-- Seleccionar --</option>
                                                    <option value="Inicial">Inicial</option>
                                                    <option value="Primaria">Primaria</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Turno</label>
                                                <select id="turno" name="turno"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white" required>
                                                    <option selected>-- Seleccionar --</option>
                                                    <option value="Mañana">Mañana</option>
                                                    <option value="Tarde">Tarde</option>
                                                </select>
                                            </div>
                                        </div>
    
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Grado</label>
                                                <select id="grade" name="grade"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white" required>
                                                    <option selected>-- Seleccione el Grado de Ingreso --</option>
                                                    <option value="1º Grado">1° Grado</option>
                                                    <option value="2º Grado">2° Grado</option>
                                                    <option value="3º Grado">3° Grado</option>
                                                    <option value="4º Grado">4° Grado</option>
                                                    <option value="5º Grado">5° Grado</option>
                                                    <option value="6º Grado">6° Grado</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Sección</label>
                                                <select id="section" name="section"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white" required>
                                                    <option selected>-- Seleccione la Seccion de Ingreso --</option>
                                                    <option value="A">A</option>
                                                    <option value="B">B</option>
                                                    <option value="C">C</option>
                                                    <option value="D">D</option>
                                                    <option value="E">E</option>
                                                    <option value="F">F</option>
                                                    <option value="G">G</option>
                                                    <option value="H">H</option>
                                                </select>
                                            </div>
                                        </div>
                                </div>
                                <h3 class="text-sm font-medium text-gray-700 mt-6 mb-4 flex items-center gap-2">
                                    <i data-lucide="file-signature" class="h-4 w-4 text-blue-600"></i>
                                    Información del Documento
                                </h3>
                                <div class="space-y-4">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de
                                                    Emisión</label>
                                                <input id="date" name="date" type="date"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Firmante</label>
                                                <select id="signature" name="signature"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white">
                                                    <option value="Fabian Leon Dionicio Cirilo" selected>Director - Fabian Leon Dionicio Cirilo</option>
                                                    <option>Subdirector - María Rodríguez López</option>
                                                    <option>Secretario - Carlos Martínez Soto</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <div class="col-span-2">
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Observaciones
                                                    (opcional)</label>
                                                <textarea rows="3" placeholder="Ingrese observaciones adicionales..."
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all"></textarea>
                                            </div>
                                            <div class="flex items-end justify-center">
                                                <button onclick="datosVacante()" class="w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-all flex items-center justify-center gap-2 shadow-sm hover:shadow btn-pulse">
                                                    <i data-lucide="file-output" class="h-5 w-5"></i>
                                                    Generar Documento
                                                </button>  
                                            </div>
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Los demás formularios estarían ocultos inicialmente -->
                    <div id="constancia-estudios"
                        class="hidden bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6 transition-all hover:shadow-md">

                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                                <i data-lucide="file-text" class="h-5 w-5 text-blue-600"></i>
                                Constancia de Estudios
                            </h2>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-gray-500">ID: DOC-2025-32004</span>
                                <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800">Oficial</span>
                            </div>
                        </div>
    
                        <div class="grid grid-cols-1 md:grid-cols-1">
                            <!-- Columna Izquierda - Formulario -->
                            <div>
                                <h3 class="text-sm font-medium text-gray-700 mb-4 flex items-center gap-2">
                                    <i data-lucide="user" class="h-4 w-4 text-blue-600"></i>
                                    Información del Estudiante
                                </h3>
                                <!-- Buscador de Estudiante -->
                                <div class="w-full mx-auto relative mb-6">
                                    <div class="relative">
                                      <i data-lucide="search" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" style="width: 18px; height: 18px;"></i>
                                      <input
                                        type="text"
                                        id="globalSearch"
                                        placeholder="Buscar por nombre, apellido o DNI..."
                                        class="w-full px-4 py-3 pl-10 border rounded-lg shadow-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all"
                                        oninput="buscarAlumnoGlobal()"
                                        aria-label="Buscar estudiante"
                                      />
                                      <button 
                                        id="clearSearchBtn" 
                                        class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 hidden"
                                        onclick="clearSearch()"
                                        aria-label="Limpiar búsqueda"
                                      >
                                        <i data-lucide="x" style="width: 16px; height: 16px;"></i>
                                      </button>
                                    </div>
                                  
                                    <ul id="resultadosBusqueda" class="mt-2 bg-white border rounded-lg shadow-lg custom-scrollbar"></ul>
                                </div>  

                                <!-- Datos del Estudiante -->
                                <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Apellidos y Nombres</label>
                                            <input id="name1" name="name1" type="text"
                                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" required>
                                        </div>

                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">DNI</label>
                                                <input id="dni1" name="dni1" type="text" placeholder="DNI del Estudiante"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" required>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Nivel Educativo</label>
                                                <select id="nivel1" name="nivel1"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white" required>
                                                    <option>-- Seleccionar --</option>
                                                    <option value="Inicial">Inicial</option>
                                                    <option value="Primaria">Primaria</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Código Modular</label>
                                                <select id="codm" name="codm"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white" required disabled>
                                                    <option selected>-- --</option>
                                                    <option value="1449909">1449909</option>
                                                    <option value="0288399">0288399</option>
                                                </select>
                                            </div>
                                        </div>
    
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Grado</label>
                                                <select id="grade1" name="grade1"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white" required>
                                                    <option selected>-- Seleccione el Grado de Ingreso --</option>
                                                    <option value="1">1° Grado</option>
                                                    <option value="2">2° Grado</option>
                                                    <option value="3">3° Grado</option>
                                                    <option value="4">4° Grado</option>
                                                    <option value="5">5° Grado</option>
                                                    <option value="6">6° Grado</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Sección</label>
                                                <select id="section1" name="section1"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white" required>
                                                    <option selected>-- Seleccione la Sección de Ingreso --</option>
                                                    <option value="A">A</option>
                                                    <option value="B">B</option>
                                                    <option value="C">C</option>
                                                    <option value="D">D</option>
                                                    <option value="E">E</option>
                                                    <option value="F">F</option>
                                                    <option value="G">G</option>
                                                    <option value="H">H</option>
                                                </select>
                                            </div>
                                        </div>
                                </div>
                                <h3 class="text-sm font-medium text-gray-700 mt-6 mb-4 flex items-center gap-2">
                                    <i data-lucide="file-signature" class="h-4 w-4 text-blue-600"></i>
                                    Información del Documento
                                </h3>
                                <div class="space-y-4">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Fecha de
                                                    Emisión</label>
                                                <input id="date1" name="date1" type="date"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all">
                                            </div>
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 mb-1">Firmante</label>
                                                <select id="signature" name="signature"
                                                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all appearance-none bg-white">
                                                    <option value="Fabian Leon Dionicio Cirilo" selected>Director - Fabian Leon Dionicio Cirilo</option>
                                                    <option>Subdirector - María Rodríguez López</option>
                                                    <option>Secretario - Carlos Martínez Soto</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <div class="flex justify-center">
                                            <button onclick="datosEstudios()" class="bg-blue-600 text-white py-2 px-6 rounded-lg hover:bg-blue-700 transition-all flex items-center justify-center gap-2 shadow-sm hover:shadow btn-pulse">
                                                <i data-lucide="file-output" class="h-5 w-5"></i>
                                                Generar Documento
                                            </button>  
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="resolucion-traslado"
                        class="hidden bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6 transition-all hover:shadow-md">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                                <i data-lucide="file-symlink" class="h-5 w-5 text-purple-600"></i>
                                Resolución de Traslado
                            </h2>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-gray-500">ID: DOC-2025-32005</span>
                                <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800">Oficial</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-center h-40">
                            <div class="text-center">
                                <i data-lucide="construction" class="h-12 w-12 text-amber-500 mx-auto mb-3"></i>
                                <h3 class="text-lg font-medium text-gray-700">En desarrollo</h3>
                                <p class="text-sm text-gray-500 mt-1">Este formulario estará disponible próximamente</p>
                            </div>
                        </div>
                    </div>

                    <div id="certificado-notas"
                        class="hidden bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6 transition-all hover:shadow-md">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                                <i data-lucide="file-bar-chart" class="h-5 w-5 text-amber-600"></i>
                                Certificado de Notas
                            </h2>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-gray-500">ID: DOC-2025-32006</span>
                                <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800">Oficial</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-center h-40">
                            <div class="text-center">
                                <i data-lucide="construction" class="h-12 w-12 text-amber-500 mx-auto mb-3"></i>
                                <h3 class="text-lg font-medium text-gray-700">En desarrollo</h3>
                                <p class="text-sm text-gray-500 mt-1">Este formulario estará disponible próximamente</p>
                            </div>
                        </div>
                    </div>

                    <div id="constancia-conducta"
                        class="hidden bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6 transition-all hover:shadow-md">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                                <i data-lucide="file-heart" class="h-5 w-5 text-red-600"></i>
                                Constancia de Conducta
                            </h2>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-gray-500">ID: DOC-2025-32007</span>
                                <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800">Oficial</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-center h-40">
                            <div class="text-center">
                                <i data-lucide="construction" class="h-12 w-12 text-amber-500 mx-auto mb-3"></i>
                                <h3 class="text-lg font-medium text-gray-700">En desarrollo</h3>
                                <p class="text-sm text-gray-500 mt-1">Este formulario estará disponible próximamente</p>
                            </div>
                        </div>
                    </div>

                    <div id="documento-personalizado"
                        class="hidden bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6 transition-all hover:shadow-md">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                                <i data-lucide="file-plus" class="h-5 w-5 text-gray-600"></i>
                                Documento Personalizado
                            </h2>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-gray-500">ID: DOC-2025-32008</span>
                                <span class="px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800">Personalizado</span>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-center h-40">
                            <div class="text-center">
                                <i data-lucide="construction" class="h-12 w-12 text-amber-500 mx-auto mb-3"></i>
                                <h3 class="text-lg font-medium text-gray-700">En desarrollo</h3>
                                <p class="text-sm text-gray-500 mt-1">Este formulario estará disponible próximamente</p>
                            </div>
                        </div>
                    </div>

                    <!-- Información Adicional -->
                    <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mt-6 transition-all hover:shadow-md animate-fade-in" style="animation-delay: 0.4s;">
                        <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <i data-lucide="info" class="h-5 w-5 text-blue-600"></i>
                            Información Adicional
                        </h2>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="text-sm font-medium text-gray-700 mb-3 flex items-center gap-2">
                                    <i data-lucide="list-checks" class="h-4 w-4 text-green-600"></i>
                                    Instrucciones
                                </h3>
                                <ul class="space-y-2 text-sm text-gray-600">
                                    <li class="flex items-start gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                                        <i data-lucide="check-circle"
                                            class="h-5 w-5 text-green-500 flex-shrink-0"></i>
                                        <span>Selecciona el tipo de documento que deseas generar</span>
                                    </li>
                                    <li class="flex items-start gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                                        <i data-lucide="check-circle"
                                            class="h-5 w-5 text-green-500 flex-shrink-0"></i>
                                        <span>Completa todos los campos requeridos en el formulario</span>
                                    </li>
                                    <li class="flex items-start gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                                        <i data-lucide="check-circle"
                                            class="h-5 w-5 text-green-500 flex-shrink-0"></i>
                                        <span>Verifica la vista previa antes de generar el documento final</span>
                                    </li>
                                    <li class="flex items-start gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                                        <i data-lucide="check-circle"
                                            class="h-5 w-5 text-green-500 flex-shrink-0"></i>
                                        <span>Puedes descargar, imprimir o enviar por correo el documento
                                            generado</span>
                                    </li>
                                </ul>
                            </div>

                            <div>
                                <h3 class="text-sm font-medium text-gray-700 mb-3 flex items-center gap-2">
                                    <i data-lucide="alert-circle" class="h-4 w-4 text-amber-600"></i>
                                    Consideraciones
                                </h3>
                                <ul class="space-y-2 text-sm text-gray-600">
                                    <li class="flex items-start gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                                        <i data-lucide="alert-circle"
                                            class="h-5 w-5 text-amber-500 flex-shrink-0"></i>
                                        <span>Los documentos generados tienen validez oficial y llevan un código de
                                            verificación</span>
                                    </li>
                                    <li class="flex items-start gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                                        <i data-lucide="alert-circle"
                                            class="h-5 w-5 text-amber-500 flex-shrink-0"></i>
                                        <span>Cada documento generado queda registrado en el sistema para futuras
                                            consultas</span>
                                    </li>
                                    <li class="flex items-start gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors">
                                        <i data-lucide="alert-circle"
                                            class="h-5 w-5 text-amber-500 flex-shrink-0"></i>
                                        <span>Las plantillas pueden ser personalizadas desde la sección de
                                            configuración</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast de notificación -->
    <div id="toast" class="toast flex items-start gap-3 max-w-xs">
        <div id="toastIcon" class="text-green-500">
            <i data-lucide="check-circle" class="h-5 w-5"></i>
        </div>
        <div class="flex-1">
            <h3 id="toastTitle" class="font-medium text-gray-900">Éxito</h3>
            <p id="toastMessage" class="text-sm text-gray-500">Operación completada correctamente</p>
        </div>
        <button id="closeToast" class="text-gray-400 hover:text-gray-500">
            <i data-lucide="x" class="h-4 w-4"></i>
        </button>
    </div>

    <script>
        // Inicializar iconos de Lucide
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            
            // Configurar toast
            const closeToastBtn = document.getElementById('closeToast');
            if (closeToastBtn) {
                closeToastBtn.addEventListener('click', hideToast);
            }
            
            // Mejorar efectos visuales para selectores
            const selects = document.querySelectorAll('select');
            selects.forEach(select => {
                select.addEventListener('focus', () => {
                    select.parentElement.classList.add('ring-2', 'ring-blue-300');
                });
                
                select.addEventListener('blur', () => {
                    select.parentElement.classList.remove('ring-2', 'ring-blue-300');
                });
            });
        });
        
        // Función para mostrar el formulario seleccionado
        function mostrarFormulario(id) {
            // Ocultar todos los formularios
            document.querySelectorAll('[id^="constancia-"], [id^="resolucion-"], [id^="certificado-"], [id^="documento-"]').forEach(form => {
                form.classList.add('hidden');
            });
            // Mostrar el formulario seleccionado
            document.getElementById(id).classList.remove('hidden');
            // Cambiar el estilo de las tarjetas
            document.querySelectorAll('.document-card').forEach(card => {
                card.classList.remove('bg-blue-50', 'border-blue-100');
                card.classList.add('bg-white', 'border-gray-100');
            });
            // Resaltar la tarjeta seleccionada
            const selectedCard = document.querySelector(`.document-card[onclick="mostrarFormulario('${id}')"]`);
            if (selectedCard) {
                selectedCard.classList.remove('bg-white', 'border-gray-100');
                selectedCard.classList.add('bg-blue-50', 'border-blue-100');
            }
            
            // Mostrar notificación
            showToast("Formulario cargado", `Formulario de ${id.replace('-', ' ')} cargado correctamente`, "info");
        }

        // Funcion para buscar un alumno entre todos los grados y secciones desde api.js usando el cache
        async function buscarAlumnoGlobal() {
            const q = document.getElementById("globalSearch").value.trim();
            const clearBtn = document.getElementById("clearSearchBtn");
            const lista = document.getElementById("resultadosBusqueda");
            lista.innerHTML = "";

            // Mostrar/ocultar botón de limpiar
            if (q.length > 0) {
                clearBtn.classList.remove('hidden');
            } else {
                clearBtn.classList.add('hidden');
            }

            if (q.length < 3) {
                if (q.length > 0) {
                    lista.innerHTML = "<li class='py-3 px-4 text-gray-500 text-sm flex items-center gap-2'><i data-lucide='search' class='h-4 w-4'></i>Escribe al menos 3 caracteres...</li>";
                    lucide.createIcons();
                }
                return;
            }

            // Mostrar indicador de carga
            lista.innerHTML = "<li class='py-3 px-4 text-blue-600 text-sm flex items-center gap-2'><div class='animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600'></div>Buscando...</li>";

            try {
                const res = await fetch(`/api/buscar-alumno?q=${encodeURIComponent(q)}`);
                const result = await res.json();

                if (!result.success || result.resultados.length === 0) {
                    lista.innerHTML = "<li class='py-3 px-4 text-amber-600 text-sm flex items-center gap-2'><i data-lucide='alert-circle' class='h-4 w-4'></i>No se encontraron coincidencias</li>";
                    lucide.createIcons();
                    return;
                }

                lista.innerHTML = "";
                result.resultados.forEach(item => {
                    const li = document.createElement("li");
                    li.className = "border-b last:border-b-0 hover:bg-blue-50 transition-colors cursor-pointer";
                    li.innerHTML = `
                        <div class="py-3 px-4">
                            <div class="font-medium text-gray-900">${item.nombre}</div>
                            <div class="flex flex-wrap gap-x-4 mt-1 text-xs text-gray-500">
                                <span>DNI: ${item.dni}</span>
                                <span>Grado ${item.grado} "${item.seccion}"</span>
                            </div>
                        </div>
                    `;

                    // ✅ evento para autocompletar
                    li.addEventListener("click", () => {
                        autocompletarFormulario(item);
                        lista.innerHTML = ""; // limpia la lista al seleccionar
                        document.getElementById("globalSearch").value = item.nombre; // muestra el nombre seleccionado
                        clearBtn.classList.remove('hidden');
                        showToast("Estudiante seleccionado", "Datos del estudiante cargados correctamente", "success");
                    });

                    lista.appendChild(li);
                });
            } 
            catch (error) {
                console.error("❌ Error en búsqueda global:", error);
                lista.innerHTML = "<li class='py-3 px-4 text-red-600 text-sm flex items-center gap-2'><i data-lucide='alert-triangle' class='h-4 w-4'></i>Error al buscar</li>";
                lucide.createIcons();
            }
        }

        function clearSearch() {
            document.getElementById("globalSearch").value = "";
            document.getElementById("resultadosBusqueda").innerHTML = "";
            document.getElementById("clearSearchBtn").classList.add('hidden');
        }

        function autocompletarFormulario(item) {
            document.getElementById("name1").value = item.nombre || "";
            document.getElementById("dni1").value = item.dni || "";
            document.getElementById("grade1").value = item.grado || "";
            document.getElementById("section1").value = item.seccion || "";
            
            // Actualizar nivel educativo basado en el grado
            const grado = parseInt(item.grado);
            if (!isNaN(grado)) {
                if (grado >= 1 && grado <= 6) {
                    document.getElementById("nivel1").value = "Primaria";
                    // Disparar el evento change para actualizar el código modular
                    const event = new Event('change');
                    document.getElementById("nivel1").dispatchEvent(event);
                }
            }
        }
        
        // Mostrar toast de notificación
        function showToast(title, message, type = "success") {
            const toast = document.getElementById("toast");
            const toastTitle = document.getElementById("toastTitle");
            const toastMessage = document.getElementById("toastMessage");
            const toastIcon = document.getElementById("toastIcon").querySelector("i");
            
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            
            // Configurar icono y color según tipo
            if (type === "success") {
                toastIcon.setAttribute("name", "check-circle");
                toastIcon.parentElement.className = "text-green-500";
            } else if (type === "error") {
                toastIcon.setAttribute("name", "alert-circle");
                toastIcon.parentElement.className = "text-red-500";
            } else if (type === "warning") {
                toastIcon.setAttribute("name", "alert-triangle");
                toastIcon.parentElement.className = "text-amber-500";
            } else if (type === "info") {
                toastIcon.setAttribute("name", "info");
                toastIcon.parentElement.className = "text-blue-500";
            }
            
            // Actualizar icono
            lucide.createIcons({
                icons: {
                    "check-circle": toastIcon,
                    "alert-circle": toastIcon,
                    "alert-triangle": toastIcon,
                    "info": toastIcon
                }
            });
            
            // Mostrar toast con animación
            toast.classList.add("show");
            
            // Ocultar automáticamente después de 5 segundos
            setTimeout(() => {
                hideToast();
            }, 5000);
        }
        
        // Ocultar toast
        function hideToast() {
            const toast = document.getElementById("toast");
            toast.classList.remove("show");
        }
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
          const nivelSelect = document.getElementById("nivel1");
          const codmSelect = document.getElementById("codm");
        
          const codigosPorNivel = {
            "Inicial": "1449909",
            "Primaria": "0288399"
          };
        
          nivelSelect.addEventListener("change", () => {
            const nivel = nivelSelect.value;
        
            // Selecciona automáticamente el código asociado
            if (codigosPorNivel[nivel]) {
              codmSelect.value = codigosPorNivel[nivel];
            } else {
              codmSelect.value = "-- --"; // o "" si usas ese valor
            }
          });
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
          const hoy = new Date();
          const yyyy = hoy.getFullYear();
          const mm = String(hoy.getMonth() + 1).padStart(2, '0');
          const dd = String(hoy.getDate()).padStart(2, '0');
          const fechaActual = `${yyyy}-${mm}-${dd}`;
        
          // Aplica la fecha actual a todos los inputs tipo date
          document.querySelectorAll('input[type="date"]').forEach(input => {
            if (!input.value) input.value = fechaActual;
          });
        });
    </script>                     
    <script>
       function datosVacante() {
            const dni = document.getElementById("dni").value;
            const lastname1 = document.getElementById("lastname1").value;
            const lastname2 = document.getElementById("lastname2").value;
            const name = document.getElementById("name").value;
            const grado = document.getElementById("grade").value;
            const seccion = document.getElementById("section").value;
            const nivel = document.getElementById("nivel").value;
            const turno = document.getElementById("turno").value;
            const director = document.getElementById("signature").value;
            const fecha = document.getElementById("date").value;

            // Validación básica
            if (!dni || !lastname1 || !lastname2 || !name || !grado || !seccion || !nivel || !turno) {
                showToast("Error", "Por favor complete todos los campos requeridos", "error");
                return;
            }

            const datos = {
                dni,
                lastname1,
                lastname2,
                name,
                grado,
                seccion,
                nivel,
                turno,
                director,
                fecha
            };

            showToast("Generando documento", "Preparando constancia de vacante...", "info");
            setTimeout(() => {
                try {
                    generarCV(datos);
                    showToast("Documento generado", "La constancia de vacante se ha generado correctamente", "success");
                } catch (error) {
                    console.error("Error al generar documento:", error);
                    showToast("Error", "No se pudo generar el documento", "error");
                }
            }, 1000);
        }

        function datosEstudios() {
            const dni = document.getElementById("dni1").value;
            const name = document.getElementById("name1").value;
            const grado = document.getElementById("grade1").value;
            const seccion = document.getElementById("section1").value;
            const nivel = document.getElementById("nivel1").value;
            const codm = document.getElementById("codm").value;
            const director = document.getElementById("signature").value;
            const fecha = document.getElementById("date1").value;

            // Validación básica
            if (!dni || !name || !grado || !seccion || !nivel) {
                showToast("Error", "Por favor complete todos los campos requeridos", "error");
                return;
            }

            const datos = {
                dni,
                name,
                grado,
                seccion,
                nivel,
                codm,
                director,
                fecha
            };

            showToast("Generando documento", "Preparando constancia de estudios...", "info");
            setTimeout(() => {
                try {
                    generarCE(datos);
                    showToast("Documento generado", "La constancia de estudios se ha generado correctamente", "success");
                } catch (error) {
                    console.error("Error al generar documento:", error);
                    showToast("Error", "No se pudo generar el documento", "error");
                }
            }, 1000);
        }
    </script>
    <script src="/js/CV.js"></script>
    <script src="/js/CE.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.15/jspdf.plugin.autotable.min.js"></script>
</body>
</html>